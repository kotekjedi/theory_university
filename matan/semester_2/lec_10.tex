% \documentclass[11pt,dvipsnames]{report}
% \input{preamble.tex}
% \begin{document}
%
\lecture{10}{17 Apr}{\dag}
\section{Условные экстремумы}
\begin{defn}[Локальный максимум]
    Пусть $ f\colon W \subset \R^{n+m} \to  \R$, $ \Phi\colon W \to  \R^{m} $ , $ z_0 \in W$, $ \Phi(z_0) = 0$ и существует такая окрестность $ U \subset W$ точки $ z_0$, что
    \[
	\forall z \in U \cap \{\Phi = 0\} \quad f(z) \le f(z_0)
    .\] 
    Тогда точка $ z_0$ называется {\sf точкой условного локального максимума} функции $ f$ при условии $ \Phi = 0$.  
\end{defn}
\begin{note}
    Аналогично определяется локальный минимум и экстремум, также строгие аналоги.
\end{note}
\begin{note}[уравнения связи]
    $ \Phi(z) = \left(\Phi_1(z), \ldots \Phi_m(z)\right)  $ тогда и только тогда, когда 
    \[
	\Phi_1(z) = 0, \ldots \Phi_m(z) = 0
    \] 
    --- $ m$ уравнений связи --- часто задают  $ n$-мерную поверхность.
\end{note}
Когда такие поверхности получаются?

Пусть $ \Phi$ непрерывно дифференцируемо в окрестности точки  $ z_0 \in W$, рассмотрим матрицу дифференциала
\[
    d\Phi (z) = 
    \begin{pmatrix}
	\frac{\partial \Phi_1}{\partial z_1}(z_0) & \ldots & \frac{\partial \Phi_1}{\partial z_{n+m}}(z_0) \\
	\vdots & \ddots & \vdots \\
	\frac{\partial \Phi_m}{\partial z_1}(z_0) & \ldots & \frac{\partial \Phi_m}{\partial z_{n+m}}(z_0)
    \end{pmatrix}
.\] 

Если $ \rank d\Phi(z_0) = m$, то в окрестности точки $ z_0$ уравнение $ \Phi(z) = 0$ задает  $ n$-мерную плоскость в  $ \R^{n+m}$.

	Если $ \rank dq(z_0) = m$, то в матрице есть $ m$ линейно  независимых столбцов. Будем считать, что последние  $ m$ линейно независимы и обозначим
	 \[
	x_1=z_1 , \ldots ~x_{n} = z_n, \quad y_1 = z_{n+1}, \ldots ~ y_m = z_{n+m}
	.\] 
	Тогда $ \det \partial _y \Phi(z_0) \ne 0 $, существует $ \left( \partial _y \Phi(z_0) \right)^{-1}$ и выполнена теорема о неявной функции:
	\[
		\Phi(z) = 0 \Longleftrightarrow  y = g(x)
	\] 
	в окрестности точки $ z_0$, $ g(x)$ --- неявная функция.

Приходим к тому, что надо искать экстремум функции
\[
    \widetilde{   f }(x)= f(x, y) = f(x, g(x)), \qquad  x = (x_1, \ldots x_{n})
.\] 
Но возникает проблемка: $ g$ задана неявно.

Если  $ z_0$ --- локальный экстремум функции $ f$ при условии, что  $ \Phi(z) = 0$, то  $ x_0$ --- локальный экстремум функции $ \widetilde{f}$. В случае гладкости обеих функций для этого есть необходимое условие экстремума
  \[
	  d \widetilde{f}(x_0) = 0 \Longleftrightarrow \partial _x f(x_0, g(x_0)) + \partial _yf(x_0, g(x_0)) dy(x_0) = 0
 .\] 
 Еще $ \Phi(x, g(x)) = 0$ в окрестности $ x_0$. Поэтому 
 \[
     \partial _x \Phi(x_0, g(x_0)) + \partial _y\Phi(x_0, g(x_0))dg(x_0) = 0
 .\] 

 Получили условие на $ x_0$:
 \[
 \begin{cases}
	 \partial _x f(x_0, g(x_0)) + \partial _y f(x_0, g(x_0)) dy(x_0) = 0\\
	 \partial _x \Phi(x_0, g(x_0)) + \partial _y\Phi(x_0, g(x_0)) dg(x_0) = 0
 \end{cases}
 .\] 
 Воспользуемся обратимостью $ \partial _y \Phi(x_0, g(x_0))$:
 \[
	 dg(x_0) = - \left( \partial _y \varphi (x_0, g(x_0)) \right)^{-1} \partial _x \Phi(x_0, g(x_0))
 .\] 
 Подставим $ dg(x_0)$ в первое уравнение:
 \[
     \partial _x f(x_0, g(x_0)) - \underbrace{\partial _y f(x_0, g(x_0)) \left( \partial _y \Phi(x_0, g(x_0)) \right)^{-1} \partial _x \Phi (x_0, g(x_0))}_{\lambda} = 0
 .\] 
\[
\begin{cases}
	
    \partial _x f(z_0) - \lambda \partial _x \Phi(z_0) = 0 \\
    \partial _y f(z_0) - \lambda \partial _y \Phi(z_0) = 0
\end{cases}
\] 
Получаем 
\begin{equation}\label{d:lag}
    df(z_0) - \lambda d\Phi(z_0) = 0
\end{equation}
$ \lambda$ --- вектор-строка длины  $ m$, так как $ \partial _y f(z_0) \in  L(\R^{m} , \R)$.

Тогда выражение \ref{d:lag} --- $ n+m$ уравнений и еще есть $ m$ уравнений на $ \Phi(z_0) = 0$.
\begin{thm}[Необходимое условие условного экстремума]
    $ W \subset \R^{n+m}$, 
	$ f \in C^{1}(W, \R)$,
	$ \Phi \in C^{1}(W, \R^{m})$,
	$ z_0 \in W$, 
	$ \rank d\Phi(z_0) = m$,
	$ \Phi(z_0) = 0$.  
	Если $ z_0$ --- точка условного локального экстремума функции $ f$ при условии  $ \Phi(z) = 0$,
	то существует  $ \lambda \in \R^{m}$ такое, что
    \[
	df(z_0) - \lambda d\Phi(z_0) = 0
    .\] 
\end{thm}
\begin{defn}
    $ \lambda$ называется {\sf множителем Лагранжа}, а метод называется {\sf методом неопределенных множителей Лагранжа}.    
\end{defn}
\begin{note}
    Система 
    \[
	df(z_0) - \lambda d\Phi(z_0) - 0, \quad \Phi(z_0) = 0
    \] 
    состоит из $ 2m+n$ уравнений с  $ 2m+n$ неизвестным $ z_0$ и $ \lambda$.
\end{note}
\subsection{Примеры}
\paragraph{Минимум и максимум квадратичной формы на сфере}
$ S^{n-1} \subset \R^{n} = \{x \in \R^{n} \mid \lvert x \rvert = 1\}$, где норма евклидова:
\[
    f\colon \R^{n} \to  \R \quad f = \sum_{j=1}^{n} \sum_{k=1}^{n} a_{jk} x_j x_k = x^{T}Ax, \quad x = (x_1, \ldots x_{n})
.\] 
Можно считать, что матрица $ A$, задающая $ a_{jk}$, симметрична ($ a_{jk} = a_{kj}$).

Запишем уравнение связи:
\[
    \Phi (x) = x_1^2 + \ldots + x_{n}^2 - 1
.\] 
Тогда $ S^{n-1}$ --- множество нулей этой функции, а $ S^{n-1}$ компактно, следовательно экстремумы достигаются. 
\[
    \exists \lambda \in  \R\colon d\left( f- \lambda \varphi  \right) (x) = 0
.\] 
Посчитаем
\[
    \frac{\partial (f-\lambda \Phi )}{\partial  x_j} (x) =  2 \sum_{k=1}^{n} a_{jk} x_k - 2 \lambda x_j
,\] 
что равносильно $ Ax = \lambda x$.
Следовательно, $ x $ --- собственный вектор матрицы $ A$, а  $ \lambda$ --- ее собственное число.
Обозначим их за $ x_s$ и  $ \lambda _s$.
Можно считать, что собственный вектор нормирован $ \lvert x_s  \rvert = 1$.
\[
	f(x_s) = x_s^{\top}A x_s = \lambda_s \underbrace{x_s^{\top}x_s}_{\lvert x_s \rvert ^2} = \lambda _s
.\] 

Значит, нужно выбрать максимальное собственное число для максимального значения и минимальное  --- для минимального.

\paragraph{Задача Дидоны}
Хотим найти максимальную площадь $ S$ ограниченную кривой фиксированной длины $ P$, при этом $ L = \{f \in C^{2}[0, l] \mid f(0) = f(l) = 0\}$.
Мы считаем, что кривая --- график некоторой функции.

\begin{figure}[ht]
    \centering
    \incfig{didiona}
    \caption{Задача Дидоны}
    \label{fig:didiona}
\end{figure}

Для решения задачи нужно максимизировать следующий функционал
\begin{align*}
	S(t) &= \int_{0}^{l} f(x) dx  \text{ при условии}\\
    \Phi(f) &= \int_{0}^{l} \sqrt{1+ (f'(x))^2 } dx - P = 0
\end{align*}

В данном случае нам требуется более общая формулировка метода множителей Лагранжа, которую мы не доказывали, но здесь он тоже работает:
если $ f$ ---  условный экстремум (экстрималь). 
\[
    \exists \lambda \in  \R\colon \forall h \in L \quad \partial _h(S - \lambda \Phi)(f) = 0
.\] 
Это выражение переписывается с помощью уравнения Эйлера-Лагранжа
\[
    (S-\lambda \Phi )(f) = \int_{0}^{l} F(x, f(x), f'(x)) dx  \qquad F(u_1, u_2, u_3) = u_2 - \lambda \sqrt{ 1+u_3^2} 
.\] 
Мы знаем, что
\[
\begin{aligned}
	\partial F - \frac{d}{dx}\partial _{x_1} F = 0\\
	\partial _2 F = 1\\
	\partial _3 F = - \lambda \frac{u_3}{\sqrt{ 1 + u_3^2} } \\
 f(l) = f(0) = 0  
\end{aligned}
\]
Подставим и перепишем
\[
    1 + \lambda \left( \frac{f'(x)}{\sqrt{ 1 + (f'(x))^2} } \right) ' = 0 
\]
Тогда
\[
    \frac{f'(x)}{\sqrt{ 1 + (f'(x))^2} } = - \frac{x +C}{\lambda}
.\] 
Возведем обе части в квадрат:
\[
 \frac{(f'(x))^2}{1+(f'(x))^2} = \frac{(x+ C)^2}{\lambda ^2}
.\] 
Выразим $ f'(x)$:
\[
    f'(x) = \sqrt{ \frac{(x+C)^2}{\lambda^2 - (x+C)^2}}  
.\] 
\[
    y = f(x) = \pm \sqrt{\lambda ^2 - (x + C)^2 } + C _1 
.\] 
\[
    (y- C_1)^2 + (x+C)^2 = \lambda^2
.\] 
Получаем, что это действительно часть окружности, которая проходит через точки $ 0$ и  $ l$ и определяется длиной веревки.
\paragraph{Задача про цепную линию}
Есть два гвоздя и цепочка длины $ P$. Необходимо понять, какую форму она примет для минимизации потенциальной энергии.
\begin{figure}[ht]
    \centering
    \incfig{chain-line}
    \caption{Задача про цепную линию}
    \label{fig:chain-line}
\end{figure}
\[
    \Phi(f) =   \int_{a}^{b} \sqrt{ 1+ (f'(x))^2}  dx - P = 0
.\] 
Хотим минимизировать потенциальную энергию, то есть
\[
    J(f) = \int_{a}^{b} f(x) \sqrt{1 + (f'(x))^2 } dx 
.\] 
Множество подходящих функций
\[
    L = \{f \in C^2[a, b] \mid f(x) = A, f(b) = B\}
.\] 
Множество допустимых приращений
\[
	L_0 = \{f \in C^2[a, b] \mid f(a) = 0, f(b) = 0\}
.\] 
Воспользуемся методом множителей Лагранжа для бесконечномерного случая.
\[
	\exists \lambda\colon \forall h \in L_0 ~ \partial _n (J - \lambda \Phi )(f) = 0
.\]
Далее воспользуемся уравнением Эйлера-Лагранжа, где
\[
    F(u_1, u_2, u_3) = (u_2-\lambda)\sqrt{ 1+ u_3^2 } 
.\] 
Первая переменная опять не используется.
Получаем следующее уравнение:
\begin{equation}\label{eq:chain}
	\partial _2 F(f, f') -\frac{d}{dx}(\partial _3 F(f, f')) = 0
\end{equation}
Если считать в лоб, то будет не понятно, как решать дифференциальное уравнение. Но мы воспользуемся тем, что $ F$ не зависит от  $ u_1$.
Докажем, что из уравнения \ref{eq:chain} следует следующее:
\[
    F(f, f') - f' \partial _3F(f, f') = C
.\] 
\begin{proof}
Продифференцируем это выражение по $ x$
\[
    \partial _2 F(f, f')f' + \cancel{ \partial _3 F(f, f') f''} - \cancel{ f'' \partial _3 F(f, f')} - f'(\partial _3 F(f, f')) = 0
.\] 
Получили, что это была константа, раз производная 0.
\end{proof}
Теперь раскроем  $ F$:
\[
    (f(x) - \lambda) \sqrt{ 1 + (f'(x))^2}  - f'(x) (f(x) - \lambda) \frac{f'(x)}{\sqrt{1+(f'(x))^2 } } = C
.\] 
Здесь нужно найти минимальное значение.


\chapter{Ряды}
\section{Определения и примеры}
\begin{defn}
    $ X$ --- нормированное пространство, $ \{x_k\}_{k=1}^{\infty} \subset X$. 
    $ \sum_{k=1}^{\infty}  x_k$ --- {\sf ряд}, $ x_k$ ---  {\sf  члены ряда}.    

    $ S_n = \sum_{k= 1}^{n} x_k$ --- {\sf частичная сумма ряда}.  
\end{defn}
\begin{defn}[сходимость ряда]
    Ряд  $ \sum_{k=1}^{\infty} x_k$ называется {\sf сходящимся}, если 
    \[
    \exists \lim_{n \to \infty} S_n \eqqcolon S
    .\] 
    Иначе ряд называется {\sf расходящимся}.  
\end{defn}
\begin{rem}
    В $ \R$ сумма ряда может быть равна  $ \pm \infty$.
\end{rem}
\begin{rem}
    Ряд может не начинаться с 1:
    \[
	\sum_{k=0}^{\infty} x_k, ~ \sum_{k=n}^{\infty} x_k
    .\] 
\end{rem}
\begin{ex}
    $ \sum_{k=1}^{\infty} 0 = 0$, этот ряд сходится.
\end{ex}
\begin{ex}
    $
	\sum_{k=1}^{\infty} (-1)^{k}
	$  расходится.
\end{ex}
\begin{ex}
    $ z \in \Cm$. $ \sum_{k=0}^{\infty} z^{k}$. Посчитаем частичную сумму $ S_n \stackrel{z\ne 1}{=} \frac{z^{n+1} -1}{z-1}$. $ \lim_{n \to \infty} z^{n}$ существует, если $ \lvert z \rvert < 1$.
\end{ex}
\begin{ex}
    $ \sum_{k=1}^{\infty} \frac{1}{k(k-1)} $ расходится, так как $ S_n = 1 - \frac{1}{n+1} \to  1$.
\end{ex}
\begin{ex}
    $ \sum_{k=0}^{\infty} \frac{x^{k}}{k!} = e^{x}$ тоже сходится.
\end{ex}
\begin{ex}
    Гармонический ряд $ \sum_{k=1}^{\infty} \frac{1}{k}$ расходится, $ H_n = \sum_{k=1}^{n} \frac{1}{k} \sim \ln n$.
\end{ex}
\subsection{Свойства}
\begin{prop}

    $ $
    \begin{description}[]
	\item[\boxed{1}] $ \sum_{k=1}^{\infty} x_k$ сходится $ \Longleftrightarrow $ $ \forall m \in \N$ сходится ряд $ \sum_{k = k+1}^{\infty} x_k $ и при этом
	    \[
		\sum_{k=1}^{\infty} x_k = \sum_{k=1}^{m}x_k + \underbrace{ \sum_{k = m+1}^{\infty} }_{\text{остаток}}
	    .\] 

	\item[\boxed{2}] $ \sum_{k=1}^{\infty} x_k $  сходится $ \Longrightarrow $ $  \sum_{k = m+1}^{\infty} x_k \stackrel{m \to  \infty}{\to} 0$
		\begin{proof}
		    Распишем формулу суммы ряда:
			\[
			S = S_m + \sum_{k = m+1}^{\infty}  x_k
			.\] 
			$ S_m$ стремиться к  $ S$ при  $ m \to  \infty$, поэтому
			\[
				\sum_{k=m+1}^{\infty} x_k  = S - S_m \stackrel{m \to  \infty}{ \to  0}
			.\] 
		\end{proof}

    \item[\boxed{\texttt{линейность}}] $ \sum_{k=1}^{\infty} x_k$ и $ \sum_{k=1}^{\infty} y_k$ сходятся. Тогда 
	\[
	    \forall \alpha , \beta  : \sum_{k=1}^{\infty} (\alpha  x_k + \beta y_k) \text{ сходится}
	\] 
	при этом
	$$
	    \forall \alpha , \beta  : \sum_{k=1}^{\infty} (\alpha  x_k + \beta y_k) = \alpha  \sum_{k=1}^{\infty} x_k + \beta \sum_{k=1}^{\infty} y_k
	    .$$
	    \begin{note}
	        Если один ряд сходится, а второй расходится, то их сумма расходится.
	    \end{note}

	\item[\boxed{ x_k \in  \R^{m} }]. 
	    \[
		\sum_{k=1}^{\infty} x_k  = \left( \sum_{k=1}^{\infty}x_k^{(0)} + \ldots + \sum_{k=1}^{\infty}  x_k^{(m)} \right) 
	    .\] 

	\item[\boxed{ z_k \in \Cm$. $ z_k = x_k + i y_k}].
	     \[
	    \sum_{k=1}^{\infty} (\alpha  x_k + i y_k) = \sum_{k=1}^{\infty} x_k +i \sum_{k=1}^{\infty} y_k
	    .\] 

	\item[\boxed{\texttt{монотонность}}] $ a_k,~ b_k \in \R$, $ a_k \le b_k$, $ \sum_{k=1}^{\infty} a_k$ и $\sum_{k=1}^{\infty} и_k$ сходится (возможно с $ \pm \infty)$, тогда
	    \[
	    \sum_{k=1}^{\infty} a_k \le \sum_{k=1}^{\infty} b_k
	    .\] 
	\item[\boxed{\texttt{необходимое условие сходимости}}] 
		$ \{x_k\} \subset X$, $ \sum_{k=1}^{\infty} x_k$ сходится, тогда $ x_k \stackrel{x \to  \infty}{ \longrightarrow} 0$.
	\item[\boxed{\texttt{критерий Больцано-Коши}}]
		Пусть $ X$ полно. $ \{x_k\} \subset X$. 
	    \[
	    \sum_{k=1}^{\infty} x_k \text{ сходится} \Longleftrightarrow \forall \varepsilon >0 ~ \exists N ~ \forall n> N ~ \forall  p \in \N: \left\| \sum_{k=n+1}^{n+p} x_k \right\| < \varepsilon 
	    .\] 
	    \begin{proof}
		Сходимость $ \sum_{k=1}^{\infty} x_k$ равносильна тому, что $ \{S_n\}$ сходится, что равносильно тому, что $ S_n$ фундаментальна в  $ X$. То есть 
		\[
		\forall \varepsilon >0 ~ \exists N ~ \forall m, n > N : \| S_m - S_n \| < \varepsilon  
		.\] 
		\[
		m > n \Longrightarrow m = n+p, ~p \in \N: S_m - S_n = \sum_{k = n+1}^{n+p} x_k 
		.\] 
	    \end{proof}
    \end{description} 
\end{prop}
% \end{document}
