\section{Существование гамильтонова пути и цикла: теорема Оре}

\begin{lemma}\label{lm:circle_1}
    Пусть $n > 2$, $a_1 \ldots a_n$ --- максимальный путь (по ребрам) в графе $G$, причем $d_{G}(a_1) + d_{G}(a_{n}) \ge n$. Тогда в графе есть цикл длины $n$.
\end{lemma}
$N_G(v)$ --- все вершины смежные с вершиной $v$ в графе $G$.

$d_G(v)$ --- степень вершины  $v$ в графе $G$.

\begin{proof}
	Разберем несколько случаев:
	\begin{itemize}
		\item Если $a_1$ и $a_{n}$ смежны, то $a_1a_2\ldots a_{n}$ --- искомый цикл.
		\item Иначе $N_{G}(a_1), N_{G}(a_{n}) \subset \{a_2, \ldots a_{n-1}\}$, так как удлинить путь нельзя.

			\begin{minipage}{0.6\textwidth}
				Если есть вершина $a_{k}$ смежная с $a_{n}$ и вершина $a_{k+1}$ смежная с $a_1$, то в графе есть цикл из $n$ вершин
					\[
					a_1a_2\ldots a_{k}a_{n}a_{n-1}\ldots a_{k+1}
					.\] 
			\end{minipage}
			\hfill
			\begin{minipage}{0.25\textwidth}
				\centering
				\incfig{lm-circle}
				\label{fig:lm-circle}
			\end{minipage}
			Пусть $N_G(a_{n}) = \{a_{i_1}, \ldots , a_{i_l}\}$.

			Если хотя бы одна из вершин $a_{i_{1}+1}, \ldots , a_{i_{l}+1}$ лежит в $N_{G}(a_1)$, то, согласно утверждению выше, в графе есть цикл длины $n$. 

			Иначе $d_G(a_1) \le n-1 - d_G(a_n)$, а это противоречит условию.
	\end{itemize}
\end{proof}

\begin{theorem}[Критерий Оре, 1960]
	\begin{enumerate}
		\item Если для любых двух несмежных вершин $u, v \in V(G)$ выполняется 
			\[
			d_G(u) + d_{G}(v) \ge v(G) - 1
			,\] 
			то в графе $G$ есть гамильтонов путь.
		\item Если  $v(G) > 2$ и для любых двух несмежных вершин  $u, v \in V(G)$ выполняется
			\[
			d_{G}(u) + d_{G}(v) \ge v(G)
			,\] 
			то в графе $G$ есть гамильтонов цикл.
	\end{enumerate}
\end{theorem}
\begin{proof}
\begin{enumerate}
	\item Докажем первое утверждение
	\begin{itemize}
	\item Для двух вершин все очевидно. Далее предположим, что  $v(G) > 2$.
	\item Рассмотрим две вершины $a$ и $b$ и  предположим, что они несмежные. По условию $d_G(a)+ d_{G}(b) \ge v(G) -1 $, поэтому $N_G(a) \cap N_G(b) \neq \varnothing$, следовательно, $a$ и $b$ связаны. Тогда граф $G$ связен.
	\item Теперь найдем наибольший простой путь $a_1\ldots a_{n}$ в графе $G$. Так как вершин больше двух, и граф связен, $n \ge 3$. Предположим, что это не гамильтонов путь, то есть $n \le v(G) - 1$.
	\item Если $a_1\ldots a_{n}$ не цикл, то по лемме \ref{lm:circle_1} существует цикл $Z$ из $n$ вершин, так как 
		\[
		d_G(a_1) + d_G(a_{n}) \ge v(G) - 1 \ge n
		.\] 
	\item Так как граф связен, существует не вошедшая в этот цикл вершина, смежная с хотя бы одной из вершин цикла. Тогда из нее и цикла можно получить путь длиной $n+1$, противоречие.
	\end{itemize}
\item По первому пункту уже есть гамильтонов путь, обозначим его за $a_1\ldots a_{n}$, где $n = v(G)$.

	Если $a_1$ и $a_n$ смежны, то мы нашли гамильтонов цикл. Иначе
	\[
	d_G(a_1) + d_G(a_{n}) \ge v(G) = n
	.\] 
	А тогда по лемме \ref{lm:circle_1} в графе есть гамильтонов цикл.
\end{enumerate}    
\end{proof}

\begin{corollary}[Критерий Дирака, 1952]
	\begin{enumerate}
		\item Если $\delta(G) \ge \frac{v(G)-1}{2}$, то в графе $G$ есть гамильтонов путь.
		\item  Если $\delta(G) \ge \frac{v(G)}{2}$, то в графе $G$ есть гамильтонов цикл.
	\end{enumerate}
\end{corollary}
